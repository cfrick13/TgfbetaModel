function dydt = TGFequations_w_FCD_nucratioz(t,y,p)
%constitutively nuclear Smad4 is modeled with a really high import rate for
%cytoplasmic Smad4 to mimic the nuclear import in cell



%==========================================================================
% Evaluate the dydt of the dimensional ODE's describing TGF-beta signalling.
% Based on Schmierer et al., 2008
%==========================================================================


% Evaluating the left hand sides of the ODE's written in standard implicit
% for, f(t,y,y')=0

% p = load('parameters_beta.dat');
dydt = zeros(25,1);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % STANDARD MODEL (from paper)
% % % % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % % % % dydt(1)  =   + p(1)*y(11) - p(2)*y(1) - p(3)*y(23)*y(1);  
% % % % % dydt(2)  = -dy(2)  + p(1)*y(12) - p(2)*y(2) - p(3)*y(23)*y(2);
% % % % % dydt(3)  =  p(1)*y(13) - p(2)*y(3) + p(3)*y(23)*y(1) - p(4)*y(3)*(y(5) + 2*y(3) + y(4)) + p(5)*(y(6) + 2*y(8) + y(9));
% % % % % dydt(4)  =  p(1)*y(14) - p(2)*y(4) + p(3)*y(23)*y(2) - p(4)*y(4)*(y(5) + y(3) + 2*y(4)) + p(5)*(y(7) + y(9) + 2*y(10));
% % % % % dydt(5)  =  p(2)*y(15) - p(2)*y(5) - p(4)*y(5)*(y(3) + y(4)) + p(5)*(y(6)+y(7));
% % % % % dydt(6)  =  p(4)*y(3)*y(5) - p(5)*y(6) - p(2)*p(6)*y(6);
% % % % % dydt(7)  =  p(4)*y(4)*y(5) - p(5)*y(7) - p(2)*p(6)*y(7);
% % % % % dydt(8)  =  p(4)*y(3)^2 - p(5)*y(8) - p(2)*p(6)*y(8);
% % % % % dydt(9)  =  p(4)*y(4)*y(3) - p(5)*y(9) - p(2)*p(6)*y(9);
% % % % % dydt(10) =  p(4)*y(4)^2 - p(5)*y(10) - p(2)*p(6)*y(10);
% % % % % dydt(11) =  p(2)*y(1) - p(1)*y(11) + p(7)*p(8)*y(13);
% % % % % dydt(12) =  p(2)*y(2) - p(1)*y(12) + p(7)*p(8)*y(14);
% % % % % dydt(13) =  p(2)*y(3) - p(1)*y(13) - p(7)*p(8)*y(13) - p(4)*y(13)*(y(15) + 2*y(13) + y(14)) + p(5)*(y(16) + 2*y(18) + y(19));
% % % % % dydt(14) =  p(2)*y(4) - p(1)*y(14) - p(7)*p(8)*y(14) - p(4)*y(14)*(y(15) + y(13) + 2*y(14)) + p(5)*(y(17) + y(19) + 2*y(20));
% % % % % dydt(15) =  p(2)*y(5) - p(2)*y(15) - p(4)*y(15)*(y(13) + y(14)) + p(5)*(y(16) + y(17));
% % % % % dydt(16) =  p(4)*y(13)*y(15) - p(5)*y(16) + p(2)*p(6)*y(6);
% % % % % dydt(17) =  p(4)*y(14)*y(15) - p(5)*y(17) + p(2)*p(6)*y(7);
% % % % % dydt(18) =  p(4)*y(13)^2 - p(5)*y(18) + p(2)*p(6)*y(8);
% % % % % dydt(19) =  p(4)*y(14)*y(13) - p(5)*y(19) + p(2)*p(6)*y(9);
% % % % % dydt(20) =  p(4)*y(14)^2 - p(5)*y(20) + p(2)*p(6)*y(10);
% % % % % 
% % % % % dydt(21) = -dy(21) - p(11)*y(21)*y(22);  %Receptors
% % % % % dydt(22) = -dy(22) - p(11)*y(21)*y(22); %TGF
% % % % % dydt(23) = -dy(23) + p(11)*y(21)*y(22); %Active Receptors
% % % % % 
% % % % % % dydt(24) = -dy(24) + p(15)*(y(16)/p(12))/(1 + y(16)/p(12)) - p(17)*y(24);  %IFFL intermediate
% % % % % % % dydt(24) = -dy(24) + p(15)*(y(16)/p(12))/(1 + y(16)/p(12)) + p(17)*y(24);  %IFFL intermediate
% % % % % % dydt(25) = -dy(25) + p(16)*(y(16)/p(13))/((1 + y(16)/p(13))*(1/(1 + y(24)/p(14)))) - p(18)*y(25);  %IFFL output gene
% % % % % 
% % % % % 
% % % % % % %working FCD circuit equations
% % % % % dydt(24) = -dy(24) + p(15)*(y(16)) - p(17)*y(24);  %IFFL intermediate
% % % % % % dydt(25) = -dy(25) + p(16)*(y(16)/(y(24)/p(19))) - p(18)*y(25);
% % % % % dydt(25) = -dy(25) + p(16)*(y(16)/y(24)) - p(18)*y(25);
% % % % % 
% % % % % 
% % % % % % dydt(24) = -dy(24) + p(20) + p(15)*y(16) - p(17)*y(24);  %IFFL intermediate
% % % % % % dydt(25) = -dy(25) + p(21) + p(16)*((y(16)/p(12))/((1)+(y(16)/p(12))+(y(24)/p(13))));
% % % % % % dydt(25) = -dy(25) + p(16)*(y(16)/(y(24)/p(19))) - p(18)*y(25);
% % % % % 




dydt(1)  =  p(1)*y(11) - p(2)*y(1) - p(3)*y(23)*y(1);  
dydt(2)  =  p(1)*y(12) - p(2)*y(2) - p(3)*y(23)*y(2);
dydt(3)  =  p(1)*y(13) - p(2)*y(3) + p(3)*y(23)*y(1) - p(4)*y(3)*(y(5) + 2*y(3) + y(4)) + p(5)*(y(6) + 2*y(8) + y(9));
dydt(4)  =  p(1)*y(14) - p(2)*y(4) + p(3)*y(23)*y(2) - p(4)*y(4)*(y(5) + y(3) + 2*y(4)) + p(5)*(y(7) + y(9) + 2*y(10));
dydt(5)  =  p(2)*y(15) - p(2)*y(5) - p(4)*y(5)*(y(3) + y(4)) + p(5)*(y(6)+y(7));
dydt(6)  =  p(4)*y(3)*y(5) - p(5)*y(6) - p(2)*p(6)*y(6);
dydt(7)  =  p(4)*y(4)*y(5) - p(5)*y(7) - p(2)*p(6)*y(7);
dydt(8)  =  p(4)*y(3)^2 - p(5)*y(8) - p(2)*p(6)*y(8);
dydt(9)  =  p(4)*y(4)*y(3) - p(5)*y(9) - p(2)*p(6)*y(9);
dydt(10) =  p(4)*y(4)^2 - p(5)*y(10) - p(2)*p(6)*y(10);
dydt(11) =  p(2)*2.3*y(1) - p(1)*2.3*y(11) + p(7)*p(8)*y(13);
dydt(12) =  p(2)*y(2) - p(1)*2.3*y(12) + p(7)*p(8)*y(14);
dydt(13) =  p(2)*2.3*y(3) - p(1)*2.3*y(13) - p(7)*p(8)*y(13) - p(4)*y(13)*(y(15) + 2*y(13) + y(14)) + p(5)*(y(16) + 2*y(18) + y(19));
dydt(14) =  p(2)*y(4) - p(1)*2.3*y(14) - p(7)*p(8)*y(14) - p(4)*y(14)*(y(15) + y(13) + 2*y(14)) + p(5)*(y(17) + y(19) + 2*y(20));
dydt(15) =  p(2)*2.3*y(5) - p(2)*2.3*y(15) - p(4)*y(15)*(y(13) + y(14)) + p(5)*(y(16) + y(17));
dydt(16) =  p(4)*y(13)*y(15) - p(5)*y(16) + p(2)*2.3*p(6)*y(6);
dydt(17) =  p(4)*y(14)*y(15) - p(5)*y(17) + p(2)*2.3*p(6)*y(7);
dydt(18) =  p(4)*y(13)^2 - p(5)*y(18) + p(2)*2.3*p(6)*y(8);
dydt(19) =  p(4)*y(14)*y(13) - p(5)*y(19) + p(2)*2.3*p(6)*y(9);
dydt(20) =  p(4)*y(14)^2 - p(5)*y(20) + p(2)*2.3*p(6)*y(10);
dydt(21) = (-1)*p(11)*y(21)*y(22);  %Receptors
dydt(22) = (-1)*p(11)*y(21)*y(22); %TGF
dydt(23) = p(11)*y(21)*y(22); %Active Receptors
% %working FCD circuit equations
dydt(24) = p(15)*(y(16)) - p(17)*y(24);  %IFFL intermediate
% dydt(25) = -dy(25) + p(16)*(y(16)/(y(24)/p(19))) - p(18)*y(25);
dydt(25) = p(16)*(y(16)/y(24)) - p(18)*y(25);













